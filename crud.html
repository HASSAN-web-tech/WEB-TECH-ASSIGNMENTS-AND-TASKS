<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BeBaker - Manage Products</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    body {
      background-color: #f5f0e6;
      color: #3b2f2f;
      font-family: 'Segoe UI', sans-serif;
    }
    header, footer {
      background-color: #8b5e3c;
      color: #fff;
      padding: 1rem 0;
    }
    header h1, footer p {
      margin: 0;
    }
    .card {
      border-color: #d4b89c;
      transition: transform 0.25s ease, box-shadow 0.25s ease;
    }
    .card:hover {
      transform: scale(1.05);
      box-shadow: 0 8px 18px rgba(0, 0, 0, 0.15);
    }
    .btn-primary {
      background-color: #8b5e3c;
      border: none;
    }
    .btn-primary:hover {
      background-color: #5e3a25;
    }
    .btn-secondary {
      background-color: #d4b89c;
      border: none;
      color: #3b2f2f;
    }
    .btn-secondary:hover {
      background-color: #b48d71;
    }
    .form-control:focus {
      box-shadow: 0 0 0 0.2rem rgba(139, 94, 60, 0.25);
    }
    .container {
      max-width: 1200px;
    }
    .img-preview {
      max-width: 100px;
      max-height: 100px;
      display: block;
      margin-top: 5px;
      border-radius: 8px;
      object-fit: cover;
    }
  </style>
</head>
<body>

<!-- Header -->
<header>
  <div class="container d-flex justify-content-between align-items-center">
    <h1>BeBaker</h1>
    <nav>
      <a href="index.html" class="text-white me-3">Home</a>
      <a href="checkout.html" class="text-white me-3">Checkout</a>
      <a href="crud.html" class="text-white">Manage Products</a>
    </nav>
  </div>
</header>

<!-- Main Content -->
<main class="container my-5">
  <h2 class="text-center mb-4">Manage Bakery Products</h2>

  <!-- Add/Edit Form -->
  <div class="card p-3 mb-4">
    <h5>Add / Edit Product</h5>
    <form id="productForm">
      <input type="hidden" id="productId">
      <div class="mb-3">
        <label class="form-label fw-bold">Product Name</label>
        <input type="text" class="form-control" id="productName" placeholder="Enter product name" required>
      </div>
      <div class="mb-3">
        <label class="form-label fw-bold">Price (Rs)</label>
        <input type="number" class="form-control" id="productPrice" placeholder="Enter price" required>
      </div>
      <div class="mb-3">
        <label class="form-label fw-bold">Description</label>
        <textarea class="form-control" id="productDesc" rows="3" placeholder="Enter product description" required></textarea>
      </div>
      <div class="mb-3">
        <label class="form-label fw-bold">Product Image</label>
        <input type="file" class="form-control" id="productImage" accept="image/*">
        <img id="imagePreview" class="img-preview d-none" alt="Preview">
      </div>
      <button type="submit" class="btn btn-primary me-2" id="saveProduct">Save</button>
      <button type="button" class="btn btn-secondary" id="resetForm">Reset</button>
    </form>
  </div>

  <!-- Products List -->
  <div id="productList" class="row g-4"></div>
</main>

<!-- Footer -->
<footer class="mt-5">
  <div class="container text-center">
    <p>&copy; 2025 BeBaker. All rights reserved.</p>
  </div>
</footer>

<!-- jQuery + Bootstrap -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
$(document).ready(function() {
  // Default bakery products
  let defaultProducts = [
    { id: 1, name: "Chocolate Cake", price: 2500, desc: "Rich and moist chocolate sponge with smooth ganache frosting.", img: "chocolate.jpg" },
    { id: 2, name: "Dubai Chocolate Cake", price: 3000, desc: "Premium dark chocolate cake with gold dusted glaze for luxury taste.", img: "dubai chocolate.png" },
    { id: 3, name: "Lotus Cake", price: 2700, desc: "Lotus biscoff cream layers with caramel drizzle and biscuit topping.", img: "lotus.png" },
    { id: 4, name: "Red Velvet Cake", price: 2600, desc: "Soft red velvet sponge with creamy vanilla frosting and sprinkles.", img: "redvelvet.png" },
    { id: 5, name: "Red Velvet Strawberry", price: 2800, desc: "Red velvet base topped with strawberry cream and fresh slices.", img: "redvelvetstrawberry.png" },
    { id: 6, name: "Vanilla Cake", price: 2200, desc: "Classic vanilla flavor with light buttercream and smooth finish.", img: "vanilla.png" }
  ];

  // Load products from localStorage or set defaults
  let products = JSON.parse(localStorage.getItem('products')) || defaultProducts;

  // Render product cards
  function renderProducts() {
    $('#productList').empty();
    products.forEach(p => {
      $('#productList').append(`
        <div class="col-md-4">
          <div class="card shadow-sm p-3 product-card">
            <img src="${p.img}" class="card-img-top rounded" alt="${p.name}">
            <div class="card-body">
              <h5 class="card-title">${p.name}</h5>
              <p class="card-text">${p.desc}</p>
              <p class="fw-bold">Price: Rs ${p.price}</p>
              <button class="btn btn-primary btn-sm editProduct" data-id="${p.id}">Edit</button>
              <button class="btn btn-secondary btn-sm deleteProduct" data-id="${p.id}">Delete</button>
            </div>
          </div>
        </div>
      `);
    });
  }

  renderProducts();

  // Hover zoom effect
  $(document).on('mouseenter', '.product-card', function() {
    $(this).css({ transform: 'scale(1.05)', boxShadow: '0 8px 18px rgba(0,0,0,0.15)', transition: '0.25s ease' });
  });
  $(document).on('mouseleave', '.product-card', function() {
    $(this).css({ transform: 'scale(1)', boxShadow: 'none', transition: '0.25s ease' });
  });

  // Image preview when adding/editing
  $('#productImage').on('change', function() {
    const file = this.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = e => {
        $('#imagePreview').attr('src', e.target.result).removeClass('d-none');
      };
      reader.readAsDataURL(file);
    }
  });

  // Reset form
  $('#resetForm').click(() => {
    $('#productForm')[0].reset();
    $('#productId').val('');
    $('#imagePreview').addClass('d-none').attr('src', '');
  });

  // Save Product (Add or Update)
  $('#productForm').submit(function(e) {
    e.preventDefault();
    const id = $('#productId').val();
    const name = $('#productName').val().trim();
    const price = $('#productPrice').val().trim();
    const desc = $('#productDesc').val().trim();
    const imgFile = $('#productImage')[0].files[0];
    const previewImg = $('#imagePreview').attr('src');
    const imgPath = imgFile ? null : previewImg || "vanilla.png";

    if (imgFile) {
      const reader = new FileReader();
      reader.onload = function(event) {
        saveProduct(id, name, price, desc, event.target.result);
      };
      reader.readAsDataURL(imgFile);
    } else {
      saveProduct(id, name, price, desc, imgPath);
    }
  });

  function saveProduct(id, name, price, desc, imgPath) {
    if (id) {
      const index = products.findIndex(p => p.id == id);
      if (index !== -1) {
        products[index].name = name;
        products[index].price = price;
        products[index].desc = desc;
        products[index].img = imgPath;
        alert(`âœ… Product updated: ${name}`);
      }
    } else {
      const newId = products.length ? Math.max(...products.map(p => p.id)) + 1 : 1;
      products.push({ id: newId, name, price, desc, img: imgPath });
      alert(`ðŸ†• Product added: ${name}`);
    }

    localStorage.setItem('products', JSON.stringify(products));
    $('#productForm')[0].reset();
    $('#productId').val('');
    $('#imagePreview').addClass('d-none').attr('src', '');
    renderProducts();
  }

  // âœ… Edit product (includes description)
  $(document).on('click', '.editProduct', function() {
    const id = $(this).data('id');
    const product = products.find(p => p.id == id);
    if (!product) return;

    $('#productId').val(product.id);
    $('#productName').val(product.name);
    $('#productPrice').val(product.price);
    $('#productDesc').val(product.desc);

    if (product.img) {
      $('#imagePreview').attr('src', product.img).removeClass('d-none');
    } else {
      $('#imagePreview').addClass('d-none').attr('src', '');
    }

    $('html, body').animate({ scrollTop: $('#productForm').offset().top - 100 }, 500);
  });

  // Delete product
  $(document).on('click', '.deleteProduct', function() {
    const id = $(this).data('id');
    if (confirm('Are you sure you want to delete this product?')) {
      products = products.filter(p => p.id != id);
      localStorage.setItem('products', JSON.stringify(products));
      renderProducts();
    }
  });
});
</script>

</body>
</html>
